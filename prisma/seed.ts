// prisma/seed.ts
import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

const linhasDeOnibus = [
  { linha: '108', descricao: 'Carlos Bezerra' },
  { linha: '115', descricao: 'Paulista' },
  { linha: '203', descricao: 'Parque Universitário' },
  { linha: '209', descricao: 'Parque São Jorge' },
  { linha: '211', descricao: 'Atlântico / Cidade de Deus' },
  { linha: '212', descricao: 'Jardim Atlântico / Coophalis' },
  { linha: '214', descricao: 'Lucia Maggi' },
  { linha: '218', descricao: 'Alfredo de Castro' },
  { linha: '221', descricao: 'Padre Lothar' },
];

// --- GEOJSONS ---
// Nota: Adicionei o "type" dentro de geometry para a função getGeom funcionar
const linha108_GeoJson = { features: [ 
    { geometry: { type: "Point", coordinates: [-54.63716913904763, -16.420371782987687] } }, 
    { geometry: { type: "LineString", coordinates: [[-54.63716803558313, -16.420369232417556], [-54.63737317595535, -16.420380266441285], [-54.63748820793998, -16.420450148574773], [-54.638312597434464, -16.41929341598744], [-54.63673890488799, -16.41821690521114], [-54.63574578921859, -16.41961265347709], [-54.6356658527377, -16.419570279642727], [-54.635170626226554, -16.427237678296194], [-54.638377924553, -16.427436326432954], [-54.63852354852874, -16.425190465848075], [-54.63852323907007, -16.425191348304594], [-54.63992685855459, -16.425269149784768], [-54.6395322306081, -16.43135914824127], [-54.64035933601669, -16.431417862520917], [-54.6401298346437, -16.434123582572354], [-54.639014070539446, -16.43405300447789], [-54.638861429324905, -16.436749187203517], [-54.63771860115848, -16.436691971555902], [-54.63742124142027, -16.43689310413683], [-54.63697763175554, -16.436871171770406], [-54.63688801653932, -16.439032569561675], [-54.63272466315851, -16.438832849896755], [-54.63253036072152, -16.440502422457925], [-54.6324187020829, -16.441686407125076], [-54.632409398076774, -16.442046360783394], [-54.63218918011289, -16.444051377587414], [-54.632179876184566, -16.444241763840836], [-54.63191287828083, -16.446553926960476], [-54.631843137834196, -16.447466941339997], [-54.631769910651855, -16.447858231500078], [-54.63175596242418, -16.448356540339176], [-54.632528002658006, -16.451736708126433], [-54.63266088927561, -16.452450404740233], [-54.632962098942, -16.4536738785405], [-54.633024112696475, -16.454090197727027], [-54.63304214063395, -16.45542771836118], [-54.63287282226901, -16.455513685892484], [-54.632143013075975, -16.456247347146586], [-54.63619029078508, -16.459959425933377], [-54.635623663983125, -16.46020642116609], [-54.63547648972684, -16.460396963554615], [-54.63542497873668, -16.46073570511402], [-54.63311331170736, -16.46317256417896], [-54.62918551287717, -16.46704250888085], [-54.6260672714194, -16.470184655653654], [-54.63005374338158, -16.473834050399134], [-54.63452986679417, -16.469381878789136]] } }, 
    { geometry: { type: "Point", coordinates: [-54.63452700534914, -16.469381878789136] } } 
] };

const linha218_BairroCentro_GeoJson = { features: [ 
    { geometry: { type: "Point", coordinates: [-54.55217690864464, -16.455162752725442] } }, 
    { geometry: { type: "LineString", coordinates: [[-54.552172008649805, -16.455158053232296], [-54.54355049761958, -16.452769761140672], [-54.54341851913159, -16.45214637719097], [-54.5408584483953, -16.451434418957035], [-54.5405594488753, -16.451375763796733], [-54.54112553841006, -16.4540831983947], [-54.54109337147037, -16.454141041402508], [-54.53765376932033, -16.45586808805855], [-54.537585975110545, -16.455981522355643], [-54.537466253420035, -16.455945555391395], [-54.53745182911993, -16.455891604930486], [-54.53487367042244, -16.45455713277805], [-54.53475114526576, -16.454541970570503], [-54.53472347829501, -16.45445478785571], [-54.53478474110105, -16.45435812878094], [-54.534929004592556, -16.45440930127343], [-54.53493888565369, -16.454458578477073], [-54.537488002905135, -16.455808878094572], [-54.53760862893127, -16.45578959725964], [-54.541104432546206, -16.453981540962445], [-54.54055953838176, -16.451375871477495], [-54.54077852940115, -16.450588067247807], [-54.54939094683965, -16.452988061793235], [-54.54786829564064, -16.457997087543177], [-54.54747775414822, -16.459359633418813], [-54.548777316466456, -16.45976645875203], [-54.54990202865201, -16.457576746124317], [-54.550853508201584, -16.456809857230482], [-54.55129888273011, -16.456353605136812], [-54.55157218073619, -16.45645068013974], [-54.55195682237395, -16.456664244976892], [-54.55899610630331, -16.456786236725748], [-54.55939994987247, -16.456714514568233], [-54.55948969288765, -16.456571070172757], [-54.55972900759596, -16.456578242394713], [-54.55982622919545, -16.456750375650728], [-54.559766400518356, -16.45685795885761], [-54.564952511293185, -16.463559197885814], [-54.56542825226673, -16.463957190302608], [-54.56559020664055, -16.46444254580389], [-54.566146924800705, -16.464704637268525], [-54.576578942194644, -16.46751367095534], [-54.5798187245646, -16.468509385504902], [-54.58507783206929, -16.47107059198575], [-54.5855891286821, -16.4712445789213], [-54.5912079754203, -16.471796230223205], [-54.591423311413905, -16.47164360085162], [-54.59162928497227, -16.471661557254862], [-54.591797808792634, -16.47186356667278], [-54.60080266204851, -16.47281220187483], [-54.60094340339097, -16.47267723729864], [-54.601151806517265, -16.472775816353746], [-54.60129753348194, -16.472891258288044], [-54.60680227111726, -16.473439908698793], [-54.60701329668096, -16.47329000994739], [-54.60734861383453, -16.470440966727168], [-54.60739101033819, -16.47025442361742], [-54.6078874809905, -16.470060500439132], [-54.60800251678833, -16.470146430505366], [-54.6079552652449, -16.470506356321565], [-54.60797826349136, -16.47073180252106], [-54.61714674884233, -16.479170069682553], [-54.62685858959041, -16.469386156793647], [-54.631653007016084, -16.473804759998373], [-54.63553351389632, -16.469865613571514], [-54.63507053465999, -16.469427276690368]] } }, 
    { geometry: { type: "Point", coordinates: [-54.63507053465999, -16.469427621128943] } } 
] };

const linha218_CentroBairro_GeoJson = { features: [ 
    { geometry: { type: "Point", coordinates: [-54.63506376433526, -16.469417688953115] } }, 
    { geometry: { type: "LineString", coordinates: [[-54.63506384511433, -16.469417514457163], [-54.63156906171338, -16.466221364370995], [-54.63000110976354, -16.46780762113292], [-54.62845900189913, -16.469377343095232], [-54.62762333358029, -16.470137415264972], [-54.62692550742966, -16.47096357732204], [-54.62417727860557, -16.473681625889796], [-54.62338926602227, -16.474519907550956], [-54.621845662760464, -16.47605220204582], [-54.62103119893308, -16.476840659385388], [-54.62029185598415, -16.47761859273244], [-54.62119921967739, -16.478439813155674], [-54.621087072886255, -16.478542465457068], [-54.62022049623047, -16.479441888360057], [-54.619746429594855, -16.47991114929826], [-54.61933352626541, -16.480355972077973], [-54.61877279312685, -16.48088389221347], [-54.61704471861377, -16.479265912326355], [-54.61628517945212, -16.478532683435944], [-54.615449179574995, -16.477779899919568], [-54.61144075894775, -16.474109258223777], [-54.61112062641645, -16.474026190203716], [-54.61093984575649, -16.47361807300956], [-54.60757207129066, -16.47049134967314], [-54.60747997345689, -16.47051566930864], [-54.607427909856156, -16.470610143950793], [-54.60713590640489, -16.473304374812088], [-54.60728671848267, -16.47344805634934], [-54.60724147449824, -16.473634111638233], [-54.60707558121334, -16.473752701060832], [-54.60687047678773, -16.47368906772094], [-54.60680110323207, -16.4735733706854], [-54.60419509999717, -16.47327834079624], [-54.60167352970575, -16.473035375521192], [-54.60106123234033, -16.472942817836625], [-54.598008807297006, -16.472644896461972], [-54.594896059142485, -16.47227755604571], [-54.58996454077223, -16.47180919030498], [-54.586983779640775, -16.471486619328033], [-54.58620081027047, -16.471425792012454], [-54.58620477519153, -16.47153794276096], [-54.586165131172564, -16.471665299856667], [-54.58603430591138, -16.471764144112754], [-54.58583806783078, -16.471733730067655], [-54.585007525720926, -16.471150167335338], [-54.58408580117684, -16.470695861820857], [-54.58093920313256, -16.4691448012984], [-54.579579699071175, -16.46850700517399], [-54.57856495818358, -16.468197484924048], [-54.57779229013427, -16.468016931643916], [-54.5764499002032, -16.467899689103533], [-54.57621516505104, -16.467850447156337], [-54.57535202398894, -16.467372096313255], [-54.57392405246253, -16.466945331506608], [-54.572055959384144, -16.46645760072154], [-54.569872437246985, -16.46586903800238], [-54.568561833983594, -16.46551496128876], [-54.5659968711671, -16.464806808047854], [-54.56513969508609, -16.46459984431968], [-54.564998783419014, -16.46437288838068], [-54.564971685155484, -16.463839280972365], [-54.564356631696015, -16.463037559295515], [-54.56105385177578, -16.458720166817855], [-54.55986371254623, -16.457170589968825], [-54.55959464900056, -16.456950469335183], [-54.55891634721678, -16.456794524207524], [-54.552473128987515, -16.456674353462745], [-54.55237583459295, -16.455214286697128], [-54.55214287373053, -16.45515412018763]] } }, 
    { geometry: { type: "Point", coordinates: [-54.55214176503557, -16.45515412018763] } } 
] };

// --- LINHA 211 ---
const linha211_BairroCentro_GeoJson = { features: [ 
  { geometry: { type: "Point", coordinates: [-54.635049997835225, -16.469402579133586] } }, 
  { geometry: { type: "Point", coordinates: [-54.56687011267813, -16.470990847519374] } }, 
  { geometry: { type: "LineString", coordinates: [[-54.56686786857183, -16.470990929155448], [-54.55970961362664, -16.47017200538795], [-54.5599243909636, -16.468584077459752], [-54.567421336431195, -16.469465814988254], [-54.56745214930628, -16.46924419996789], [-54.56743982379545, -16.469093501790795], [-54.56805436738573, -16.465378152856644], [-54.56512260703701, -16.464595939666836], [-54.565011029958086, -16.46438931526275], [-54.56496486013178, -16.46421220845542], [-54.56512645452287, -16.46406092959569], [-54.56529574388463, -16.464035101485408], [-54.565495813129445, -16.46414948308866], [-54.56554967792647, -16.464315520778896], [-54.565745896461706, -16.46455535272625], [-54.56669367516379, -16.464898400313942], [-54.57194328689273, -16.466296474307114], [-54.574357941578384, -16.466972490837307], [-54.57636365236638, -16.467450552148918], [-54.576461016235285, -16.467289953775662], [-54.576944954876495, -16.465841985549375], [-54.5769817056465, -16.465718241386583], [-54.57709114104196, -16.46568456421396], [-54.577181792939854, -16.46571510867129], [-54.577220175917105, -16.465817707000056], [-54.5771924085052, -16.465895242911273], [-54.577007021290555, -16.46597121236867], [-54.57694250388768, -16.466045614936874], [-54.576888603115336, -16.466193637372967], [-54.576574898831865, -16.467244848981153], [-54.57655698452041, -16.467333609714217], [-54.57659579885632, -16.46749681475984], [-54.580315700718955, -16.46871780155439], [-54.584889917325484, -16.47096132980377], [-54.58518090499602, -16.471110820642878], [-54.585641637679615, -16.4712337344679], [-54.58622361592377, -16.47129020904866], [-54.59117785631396, -16.471797594187635], [-54.591427377689854, -16.471645052569997], [-54.59162075283899, -16.471677955312458], [-54.591817250922915, -16.471869380036225], [-54.592868358706596, -16.47199500211684], [-54.60068972631335, -16.472803917405813], [-54.600889475486284, -16.472706929268796], [-54.601063940215596, -16.472680257644996], [-54.601124622424365, -16.472835438251792], [-54.60183006738346, -16.47293970028643], [-54.60680863730843, -16.473434337216958], [-54.606894600156394, -16.473330075660897], [-54.60702102387333, -16.473291280695477], [-54.60718078026555, -16.471733731183214], [-54.607354524550644, -16.470388407572017], [-54.60739694226892, -16.470251839836294], [-54.60788427286896, -16.47007219134811], [-54.6079992650982, -16.47014410860804], [-54.60795426894323, -16.47050369408707], [-54.60797608540231, -16.47073252119209], [-54.610666218072254, -16.47321181351748], [-54.61122852776212, -16.47374667465101], [-54.611540416366296, -16.474004280973347], [-54.617133419555, -16.47916715753101], [-54.61876684730905, -16.48067734245356], [-54.619082990748225, -16.48036295609603], [-54.619404990364515, -16.48003734080197], [-54.61970357140699, -16.47972295165367], [-54.620177790212566, -16.47927943919133], [-54.62077495473643, -16.478684345147443], [-54.62109109713897, -16.47834188347467], [-54.621863896868504, -16.47755028985773], [-54.62265425916094, -16.476764306784546], [-54.62575465187096, -16.473632282178684], [-54.627710232239394, -16.471649326771058], [-54.62606472350019, -16.470184957123564], [-54.62685659260893, -16.469399512327143], [-54.630847241663005, -16.473058433538924], [-54.631669166959725, -16.473799284272474], [-54.63477022752046, -16.47061222831981], [-54.63552386164689, -16.46987766132601], [-54.63504949299012, -16.469402707262503]] } } 
] };

const linha211_CentroBairro_GeoJson = { features: [ 
  { geometry: { type: "Point", coordinates: [-54.635049997835225, -16.469402579133586] } }, 
  { geometry: { type: "LineString", coordinates: [[-54.63504870034967, -16.469400332313555], [-54.63160216442425, -16.466247823430734], [-54.63077634431379, -16.467017014591292], [-54.630007484453174, -16.467818056862413], [-54.62844603264904, -16.469379172393644], [-54.6276486965218, -16.470139244791582], [-54.630818738781244, -16.473045333579662], [-54.62731218614202, -16.47661254518563], [-54.62574623624201, -16.478173844175856], [-54.62418430779644, -16.47972326986131], [-54.62331547302931, -16.480608852416296], [-54.62220224076782, -16.47956647949674], [-54.62108195270197, -16.478533417931487], [-54.61975489416898, -16.47990278565038], [-54.61933590733429, -16.480351142432298], [-54.61877954319144, -16.48087378464251], [-54.61790446231592, -16.48003147550682], [-54.61546021822994, -16.477790691525925], [-54.61402272237589, -16.476475102948285], [-54.61233303608087, -16.474922505110897], [-54.61144498807538, -16.47410612510363], [-54.61113187519359, -16.474030003096033], [-54.61105249407636, -16.47385238463751], [-54.61094003804118, -16.473617674711832], [-54.60757207129066, -16.47049134967314], [-54.60747997345689, -16.47051566930864], [-54.607427909856156, -16.470610143950793], [-54.60713264466668, -16.47330648336178], [-54.60727356716063, -16.47344805634934], [-54.607263500978206, -16.47363789272518], [-54.60706553842651, -16.47375372497889], [-54.606951458311926, -16.4737247669225], [-54.6068038252223, -16.473573541442946], [-54.6041967920938, -16.47327752670624], [-54.601079752622, -16.47294933487305], [-54.598150601801336, -16.47265975265151], [-54.5964528293964, -16.47244739337367], [-54.59490941122998, -16.472283297879244], [-54.58699486176036, -16.47149262727538], [-54.58620869998545, -16.47143513470843], [-54.58620146247932, -16.471563536313866], [-54.586071184381325, -16.47177175546942], [-54.58575815506184, -16.471752668722417], [-54.585492169867265, -16.471799517979235], [-54.58347878813629, -16.47561359965536], [-54.58340975186647, -16.47575324271176], [-54.58441689222836, -16.475967469443646], [-54.58433062359967, -16.476093593158325], [-54.58417222995479, -16.47612478493643], [-54.58370047192919, -16.47748628899143], [-54.583227992699605, -16.479176541538607], [-54.581342038381734, -16.4786321927499], [-54.58161661639498, -16.477790102957172], [-54.582298396779635, -16.475615664335393], [-54.58182792604704, -16.475498481490163], [-54.58189508707869, -16.47540475999726], [-54.57959746601631, -16.474974786800388], [-54.57981060074677, -16.473703883269522], [-54.577062730485125, -16.473219925693385], [-54.57286853512572, -16.472489490926975], [-54.57384461189237, -16.46733093491119], [-54.57197830810426, -16.4669435790764], [-54.57181632712927, -16.468612278486347], [-54.56879603851506, -16.469462650567053], [-54.56860197365684, -16.46952803794393], [-54.568405286299935, -16.469359539658157], [-54.56746381044218, -16.469238824351052], [-54.56721697590088, -16.471030355017135], [-54.56687011267813, -16.470990847519374]] } } 
] };

// --- LINHA 212 ---
const linha212_BairroCentro_GeoJson = { features: [ 
  { geometry: { type: "Point", coordinates: [-54.56687011267813, -16.470990847519374] } }, 
  { geometry: { type: "Point", coordinates: [-54.635049997835225, -16.469402579133586] } }, 
  { geometry: { type: "LineString", coordinates: [[-54.56686611708069, -16.470988956660037], [-54.558262506031284, -16.469983871891017], [-54.55848899070254, -16.468425474194348], [-54.56285533260814, -16.468954010009256], [-54.5674252356696, -16.46946512947875], [-54.56745695572896, -16.469244683187426], [-54.567431459012525, -16.46908727889685], [-54.56804761862723, -16.465378441470847], [-54.56537804331377, -16.464645903177725], [-54.56513578627238, -16.464591678784117], [-54.56499571042016, -16.464365831755686], [-54.564966940042936, -16.464189727066298], [-54.56512930163176, -16.46405805868389], [-54.56530762928767, -16.464036315061776], [-54.56548049299451, -16.464129217345146], [-54.56554922788543, -16.464333696526964], [-54.56553878231395, -16.464458308366645], [-54.5662840666305, -16.464771096673275], [-54.56836602766141, -16.465328748888666], [-54.570878293614484, -16.4660170350852], [-54.573454285729895, -16.466717232066372], [-54.5746586661724, -16.467047170868014], [-54.57635535930673, -16.467456481986744], [-54.576414315937384, -16.467350012533217], [-54.57645840849649, -16.46729369616574], [-54.57694247375291, -16.46584770032493], [-54.57697666740286, -16.46572365953071], [-54.5770630533152, -16.46568132697817], [-54.57715858619078, -16.465704968892155], [-54.57721055642389, -16.465766297301997], [-54.577218101054385, -16.465853372702952], [-54.577166390583784, -16.465916794116396], [-54.577001014640345, -16.465973974640946], [-54.57693525236846, -16.466059324124515], [-54.576555444872426, -16.46732082884904], [-54.576595113791896, -16.467497543243113], [-54.57796617580654, -16.46791997996182], [-54.57945870742432, -16.46839160566043], [-54.58038932292183, -16.46876068552038], [-54.58378773126216, -16.470425502949325], [-54.585118454290665, -16.47109816394996], [-54.58564352868254, -16.471247911244163], [-54.58593145993491, -16.471349244389756], [-54.58621478751613, -16.471533074703487], [-54.58693862074571, -16.47199612237864], [-54.59663212789984, -16.47673088843993], [-54.59694463297596, -16.476870538272436], [-54.597132585218546, -16.476822567793022], [-54.59726373114073, -16.476923369174614], [-54.59742445454583, -16.47714406284453], [-54.60071381908806, -16.47872197019757], [-54.60396370912399, -16.48033227214262], [-54.604855320781795, -16.480723691425595], [-54.606535150379386, -16.481199656129093], [-54.60784768653009, -16.481536213417755], [-54.60807243716124, -16.481501311652607], [-54.60814666362488, -16.4813641197438], [-54.60847568451284, -16.48016211071753], [-54.60857503879666, -16.480013848783088], [-54.6100191923714, -16.47856534386804], [-54.61104908055084, -16.479490100066556], [-54.612029020905325, -16.4784961540867], [-54.61282182891968, -16.477708382449507], [-54.61361156975218, -16.476894598281703], [-54.61403445716607, -16.476481159259535], [-54.611456987151314, -16.47410779882931], [-54.6110116539722, -16.47403172114163], [-54.607266159581286, -16.473632580192813], [-54.607061877472475, -16.473761189208204], [-54.60694573451315, -16.473746464056404], [-54.60679238263768, -16.473567744734794], [-54.60681727084176, -16.473439837140816], [-54.607005812151144, -16.47328234742544], [-54.607175951033824, -16.47175037677829], [-54.60734582143202, -16.470403590129408], [-54.6073852583644, -16.470247592277232], [-54.60790496868903, -16.470070893074407], [-54.60799318628081, -16.470144523488997], [-54.607946120662945, -16.470491814456338], [-54.60796511108124, -16.470714070610043], [-54.60957934287835, -16.47224896126329], [-54.61114309905878, -16.473676783279075], [-54.61154737648387, -16.474020327196598], [-54.61392428169431, -16.47619135071737], [-54.616363875984604, -16.478469076596028], [-54.617182334677295, -16.47922334430973], [-54.618007599359004, -16.47961937529495], [-54.618758291062164, -16.48068455398571], [-54.621093852591514, -16.478352573428353], [-54.62185591113426, -16.47755028985773], [-54.62105414749732, -16.47684251246048], [-54.621053847237704, -16.476843593290397], [-54.62024491873315, -16.476070740745115], [-54.62420340421119, -16.47209249885674], [-54.62475495796896, -16.47151131669932], [-54.626072203519996, -16.47019587953774], [-54.62685884700993, -16.469395446016065], [-54.630822345840386, -16.473062953644515], [-54.63164600543925, -16.47381042290155], [-54.634001236896935, -16.471426906251153], [-54.634765006726326, -16.470635947489868], [-54.63553950435329, -16.469869947321058], [-54.635049997835225, -16.469402579133586]] } } 
] };

const linha212_CentroBairro_GeoJson = { features: [ 
  { geometry: { type: "Point", coordinates: [-54.56687011267813, -16.470990847519374] } }, 
  { geometry: { type: "Point", coordinates: [-54.635049997835225, -16.469402579133586] } }, 
  { geometry: { type: "LineString", coordinates: [[-54.635049997835225, -16.469402579133586], [-54.63159842303838, -16.46623916998105], [-54.629993770225965, -16.46781762241166], [-54.62843262983816, -16.469375188215523], [-54.6276443937023, -16.47015699541018], [-54.6269160168339, -16.470966751383912], [-54.6261479162666, -16.471711920270906], [-54.62340689919711, -16.474487181749893], [-54.62029517602012, -16.477626677898925], [-54.62120253218684, -16.47844752098922], [-54.621095450054526, -16.478538620660103], [-54.620218471855, -16.47943205192513], [-54.61876911760443, -16.480874796117888], [-54.61790507164169, -16.480028892226713], [-54.616291304631886, -16.478542293106457], [-54.61403114352569, -16.476472716099977], [-54.61298829260613, -16.47553090900263], [-54.61143759200466, -16.474102397774715], [-54.61110135870375, -16.47402345070553], [-54.60725748830659, -16.473633918158725], [-54.6070744046109, -16.473759800481517], [-54.60695359708991, -16.47373842184976], [-54.60679356012743, -16.473560843297506], [-54.606809420683845, -16.47344084774889], [-54.60701062172939, -16.473292194790588], [-54.60718219771053, -16.47174369618611], [-54.60735957801373, -16.47039804946955], [-54.60738326845079, -16.470263807285136], [-54.60789574668611, -16.470065707869338], [-54.60799166792667, -16.470148212789354], [-54.60793917127708, -16.47049134967314], [-54.607965093929764, -16.4707139781452], [-54.61123442441583, -16.47374896152286], [-54.614132907060224, -16.476387061181867], [-54.614124284181685, -16.476475884207858], [-54.61398665699575, -16.476524489822665], [-54.611040806334, -16.479489928754347], [-54.6106909661963, -16.479870595830363], [-54.60948851520236, -16.481042736808234], [-54.60848493145147, -16.480170271116194], [-54.6081499460488, -16.48137226992118], [-54.608203883464, -16.481640665744038], [-54.60823791099314, -16.481862602746077], [-54.60731256490199, -16.481610444203113], [-54.606685408970435, -16.481347088610917], [-54.604890651869965, -16.480839051570683], [-54.604239573184216, -16.480555727527857], [-54.60013682320968, -16.47855084129459], [-54.59736838820564, -16.477228536071365], [-54.59702577195233, -16.477244037823922], [-54.59690670133793, -16.477187724630227], [-54.596808400881116, -16.476999152281536], [-54.59660883722766, -16.476825793310482], [-54.59009701406616, -16.47366426963437], [-54.58771418960747, -16.472480008296486], [-54.586848907714156, -16.472047605859572], [-54.58584699887608, -16.47173994373098], [-54.58584532920467, -16.471740240930558], [-54.585522224387475, -16.47152064048265], [-54.58500679495344, -16.47114915299622], [-54.58407752743108, -16.470698982979798], [-54.58328935684797, -16.470307252211427], [-54.580934036250056, -16.469152857770155], [-54.58085863682072, -16.469511481424206], [-54.5800066743481, -16.473729185971948], [-54.576122931328925, -16.473061346236022], [-54.57288774904558, -16.472483097302003], [-54.573087281664655, -16.471379543856273], [-54.57332890505552, -16.470194728039814], [-54.5738463382623, -16.46732228544012], [-54.57197246202598, -16.466938303370668], [-54.571822870920656, -16.4686021027767], [-54.57060917920636, -16.468942874761765], [-54.57050593147012, -16.470072883023775], [-54.5703853255127, -16.471303869459902], [-54.56687011267813, -16.470990847519374]] } } 
] };

// --- FUNÇÕES AUXILIARES ---
const invertCoordinates = (coords: any): [number, number] => [coords[1], coords[0]];
const invertCoordinateList = (coordsList: any): [number, number][] => {
  if (!coordsList) return [];
  return coordsList.map((coord: any) => [coord[1], coord[0]]);
};

function getGeom(features: any[], type: string) {
  const f = features.find(feat => feat.geometry && feat.geometry.type === type);
  return f ? f.geometry.coordinates : null;
}

const horariosPadraoParque = {
  bairroCentro: ['05:25', '06:25', '07:30', '08:40', '09:50', '11:00', '12:10', '13:20', '14:30', '15:40', '16:50', '18:00', '19:10', '20:20', '21:30', '22:30', '23:40'],
  centroBairro: ['05:55', '06:55', '08:05', '09:15', '10:25', '11:35', '12:45', '13:55', '15:05', '16:15', '17:25', '18:35', '19:45', '20:55', '22:05', '23:05']
};

async function main() {
  console.log('Iniciando o processo de seeding...');

  await prisma.routeShape.deleteMany({});
  await prisma.horario.deleteMany({});
  await prisma.linhas_recentes.deleteMany({});

  const drivers = [
    { login: '108', name: '108 - Carlos Bezerra' },
    { login: '211', name: '211 - Atlântico / Cid. Deus' },
    { login: '212', name: '212 - Jardim Atlântico' },
    { login: '218', name: '218 - Alfredo de Castro' },
  ];
  for (const d of drivers) {
    await prisma.systemBus.upsert({
      where: { login: d.login },
      update: { route_number: parseInt(d.login), role: 'DRIVER' },
      create: { name: d.name, login: d.login, password: d.login, route_number: parseInt(d.login), role: 'DRIVER' },
    });
  }

  const descricoes = linhasDeOnibus.map(l => l.descricao);
  await prisma.itinerarios.deleteMany({ where: { descricao: { notIn: descricoes } } });

  await prisma.$transaction(async (tx) => {
    for (const linha of linhasDeOnibus) {
      const itinerario = await tx.itinerarios.upsert({
        where: { descricao: linha.descricao },
        update: { linha: linha.linha },
        create: { linha: linha.linha, descricao: linha.descricao },
      });

      console.log(`Processando Linha ${linha.linha}...`);
      await tx.horario.deleteMany({ where: { itinerario_id: itinerario.id } });
      await tx.routeShape.deleteMany({ where: { itinerario_id: itinerario.id } });

      if (linha.linha === '108') {
        await tx.horario.createMany({
          data: [
            { itinerario_id: itinerario.id, sentido: 'BAIRRO → CENTRO', diaDaSemana: 'Dias Úteis', partidas: ['05:25', '06:25', '07:30', '08:40', '09:50', '11:00', '12:10', '13:20', '14:30', '15:40', '16:50', '18:00', '19:10', '20:20', '21:30', '22:30', '23:40'] },
            { itinerario_id: itinerario.id, sentido: 'CENTRO → BAIRRO', diaDaSemana: 'Dias Úteis', partidas: ['06:00', '07:00', '08:00', '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00', '21:00', '22:00'] },
          ],
        });
        const line = getGeom(linha108_GeoJson.features, 'LineString');
        const start = linha108_GeoJson.features[2].geometry.coordinates;
        const end = linha108_GeoJson.features[0].geometry.coordinates;
        await tx.routeShape.create({ data: { itinerario_id: itinerario.id, sentido: 'CENTRO → BAIRRO', coordinates: invertCoordinateList(line), startPoint: invertCoordinates(start), endPoint: invertCoordinates(end) } });
      }

      else if (linha.linha === '211') {
        await tx.horario.createMany({
          data: [
            { itinerario_id: itinerario.id, sentido: 'BAIRRO → CENTRO', diaDaSemana: 'Dias Úteis', partidas: ['06:00', '07:20', '08:00', '09:20', '11:20', '12:40', '14:00', '15:20', '16:40', '18:00', '19:20', '20:40', '22:10'] },
            { itinerario_id: itinerario.id, sentido: 'CENTRO → BAIRRO', diaDaSemana: 'Dias Úteis', partidas: ['05:20', '06:40', '08:40', '10:00', '10:40', '12:00', '13:20', '14:40', '16:00', '17:20', '18:40', '20:00', '21:30', '22:50'] },
          ],
        });
        const bc_line = getGeom(linha211_BairroCentro_GeoJson.features, 'LineString');
        await tx.routeShape.create({ data: { itinerario_id: itinerario.id, sentido: 'BAIRRO → CENTRO', coordinates: invertCoordinateList(bc_line), startPoint: invertCoordinates(bc_line[0]), endPoint: invertCoordinates(bc_line[bc_line.length - 1]) } });
        const cb_line = getGeom(linha211_CentroBairro_GeoJson.features, 'LineString');
        await tx.routeShape.create({ data: { itinerario_id: itinerario.id, sentido: 'CENTRO → BAIRRO', coordinates: invertCoordinateList(cb_line), startPoint: invertCoordinates(cb_line[0]), endPoint: invertCoordinates(cb_line[cb_line.length - 1]) } });
      }

      else if (linha.linha === '212') {
        await tx.horario.createMany({
          data: [
            { itinerario_id: itinerario.id, sentido: 'BAIRRO → CENTRO', diaDaSemana: 'Dias Úteis', partidas: ['05:40', '07:00', '08:20', '09:40', '11:00', '12:20', '13:40', '15:00', '16:20', '17:40'] },
            { itinerario_id: itinerario.id, sentido: 'CENTRO → BAIRRO', diaDaSemana: 'Dias Úteis', partidas: ['06:20', '07:40', '09:00', '10:20', '11:40', '13:00', '14:20', '15:40', '17:00', '18:20'] },
          ],
        });
        const bc_line = getGeom(linha212_BairroCentro_GeoJson.features, 'LineString');
        await tx.routeShape.create({ data: { itinerario_id: itinerario.id, sentido: 'BAIRRO → CENTRO', coordinates: invertCoordinateList(bc_line), startPoint: invertCoordinates(bc_line[0]), endPoint: invertCoordinates(bc_line[bc_line.length - 1]) } });
        const cb_line = getGeom(linha212_CentroBairro_GeoJson.features, 'LineString');
        await tx.routeShape.create({ data: { itinerario_id: itinerario.id, sentido: 'CENTRO → BAIRRO', coordinates: invertCoordinateList(cb_line), startPoint: invertCoordinates(cb_line[0]), endPoint: invertCoordinates(cb_line[cb_line.length - 1]) } });
      }

      else if (['209', '218'].includes(linha.linha)) {
        await tx.horario.createMany({ data: [{ itinerario_id: itinerario.id, sentido: 'BAIRRO → CENTRO', diaDaSemana: 'Dias Úteis', partidas: horariosPadraoParque.bairroCentro }, { itinerario_id: itinerario.id, sentido: 'CENTRO → BAIRRO', diaDaSemana: 'Dias Úteis', partidas: horariosPadraoParque.centroBairro }] });
        if (linha.linha === '218') {
          const bc_line = getGeom(linha218_BairroCentro_GeoJson.features, 'LineString');
          await tx.routeShape.create({ data: { itinerario_id: itinerario.id, sentido: 'BAIRRO → CENTRO', coordinates: invertCoordinateList(bc_line), startPoint: invertCoordinates(bc_line[0]), endPoint: invertCoordinates(bc_line[bc_line.length - 1]) } });
          const cb_line = getGeom(linha218_CentroBairro_GeoJson.features, 'LineString');
          await tx.routeShape.create({ data: { itinerario_id: itinerario.id, sentido: 'CENTRO → BAIRRO', coordinates: invertCoordinateList(cb_line), startPoint: invertCoordinates(cb_line[0]), endPoint: invertCoordinates(cb_line[cb_line.length - 1]) } });
        }
      }

      else if (linha.linha === '203') {
        await tx.horario.createMany({ data: [{ itinerario_id: itinerario.id, sentido: 'BAIRRO → CENTRO', diaDaSemana: 'Dias Úteis', partidas: ['05:20', '06:40', '08:00', '09:20', '10:40', '12:00', '13:20', '14:40', '16:00', '17:20', '18:40', '20:00', '21:20'] }, { itinerario_id: itinerario.id, sentido: 'CENTRO → BAIRRO', diaDaSemana: 'Dias Úteis', partidas: ['06:00', '07:20', '08:40', '10:00', '11:20', '12:40', '14:00', '15:20', '16:40', '18:00', '19:20', '20:40', '22:00'] }] });
      }
      else if (linha.linha === '214') {
        await tx.horario.createMany({ data: [{ itinerario_id: itinerario.id, sentido: 'BAIRRO → CENTRO', diaDaSemana: 'Dias Úteis', partidas: ['05:25', '06:45', '08:05', '10:40', '12:00', '13:20', '16:55'] }, { itinerario_id: itinerario.id, sentido: 'CENTRO → BAIRRO', diaDaSemana: 'Dias Úteis', partidas: ['06:05', '07:25', '08:45', '11:20', '12:40', '14:00', '17:35'] }] });
      }
      else if (linha.linha === '221') {
        await tx.horario.createMany({ data: [{ itinerario_id: itinerario.id, sentido: 'BAIRRO → CENTRO', diaDaSemana: 'Dias Úteis', partidas: ['04:50', '06:05', '07:25', '08:45', '10:05', '11:25', '12:45'] }, { itinerario_id: itinerario.id, sentido: 'CENTRO → BAIRRO', diaDaSemana: 'Dias Úteis', partidas: ['05:30', '06:50', '08:10', '09:30', '10:50', '12:10', '13:30'] }] });
      }
      else if (linha.linha === '115') {
        await tx.horario.createMany({ data: [{ itinerario_id: itinerario.id, sentido: 'BAIRRO → CENTRO', diaDaSemana: 'Dias Úteis', partidas: ['06:00', '07:40', '09:45', '10:15', '11:00', '13:00', '14:20'] }, { itinerario_id: itinerario.id, sentido: 'CENTRO → BAIRRO', diaDaSemana: 'Dias Úteis', partidas: ['07:00', '08:20', '09:00', '10:15', '11:40', '12:20', '13:30', '15:00'] }] });
      }
    }
  });

  console.log('Seeding finalizado com sucesso.');
}

main().catch(e => { console.error(e); process.exit(1); }).finally(async () => { await prisma.$disconnect(); });